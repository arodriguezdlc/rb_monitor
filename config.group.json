{   
  "conf": {
    "debug": 100,
    "stdout": 1,
    "syslog": 0,
    "threads": 1,
    "timeout": 30,
    "max_snmp_fails": 2,
    "max_kafka_fails": 2,
    "sleep_main_thread": 25,
    "sleep_worker_thread": 5,
    "kafka_broker": "kafka.redborder.cluster",
    "kafka_topic": "rb_monitor",
    "kafka_timeout": 2
  },
  "sensors":
  [
    {
      "sensor_id":5,
      "timeout":5,
      "sensor_name": "e5sensor",
      "sensor_ip": "192.168.101.121", /* This field is better after sensor_name, so we can debug it */
      "community" : "redBorder",
      "monitors": /* this field MUST be the last! */
      [
        /* OID extracted from http://www.debianadmin.com/linux-snmp-oids-for-cpumemory-and-disk-statistics.html */
        {"name": "load_5", "oid": "UCD-SNMP-MIB::laLoad.2", "unit": "%", "kafka": 1 },
        {"name": "cpu_idle", "oid":"UCD-SNMP-MIB::ssCpuIdle.0", "unit":"%"},
        {"name": "cpu", "op":"100-cpu_idle", "unit":"%", "kafka": 1},
        
        {"name": "memory_total", "oid": "UCD-SNMP-MIB::memTotalReal.0" },
        {"name": "memory_free",  "oid": "UCD-SNMP-MIB::memAvailReal.0" },
        {"name": "memory",  "op": "100*(memory_total-memory_free)/memory_total", "unit": "%", "kafka": 1},

        {"name": "swap_total", "oid": "UCD-SNMP-MIB::memTotalSwap.0" },
        {"name": "swap_free",  "oid": "UCD-SNMP-MIB::memAvailSwap.0" },
        {"name": "swap",       "op": "100*(swap_total-swap_free)/swap_total", "unit": "%", "kafka": 1},

        /* includeAllDisks 10% must be present in snmpd.conf */
        {"name": "disk",  "oid": "UCD-SNMP-MIB::dskPercent.1", "unit": "%", "kafka": 1},

        {"name": "system_temp",      "oid": ".1.3.6.1.4.1.39483.1.3.1.1.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "unit": "celsius", "kafka": 1},
        {"name": "peripheral_temp",  "oid": ".1.3.6.1.4.1.39483.1.3.1.2.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "unit": "celsius", "kafka": 1},
        {"name": "pch_temp",         "oid": ".1.3.6.1.4.1.39483.1.3.1.3.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "unit": "celsius", "kafka": 1},
        {"name": "fan",              "oid": ".1.3.6.1.4.1.39483.1.3.2.1.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "unit": "rpm", "kafka": 1, "name_split_suffix":"_per_instance", "split":";", "split_op":"mean", "instance_prefix":"fan-"},

        /* snort group monitoring "default" */
        {"name":"pkt_drop_percent", "oid":".1.3.6.1.4.1.39483.1.1.0.2.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"%", "kafka":1, "split":";", "split_op":"mean", "instance_prefix":"instance-","group_id":6, "group_name":"default"},
        {"name":"wire_mbits_per_sec_realtime", "oid":".1.3.6.1.4.1.39483.1.1.0.3.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"Mbit/s", "kafka":0, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default","kafka":0 },
        {"name":"wire_bits_per_sec_realtime", "op":"1000000*wire_mbits_per_sec_realtime_gid_6", "name_split_suffix":"_per_instance", "unit":"bits/s", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default", "kafka":0},
        {"name":"alerts_per_second", "oid":".1.3.6.1.4.1.39483.1.1.0.4.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"alerts/s", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"kpackets_wire_per_sec_realtime", "oid":".1.3.6.1.4.1.39483.1.1.0.5.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"pkts/s", "kafka":0, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"packets_wire_per_sec_realtime", "op":"1000*kpackets_wire_per_sec_realtime_gid_6", "name_split_suffix":"_per_instance", "unit":"pkts/s", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"avg_bytes_per_wire_packet", "oid":".1.3.6.1.4.1.39483.1.1.0.6.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"bytes", "kafka":1, "split":";", "split_op":"mean", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"patmatch_percent", "oid":".1.3.6.1.4.1.39483.1.1.0.7.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"%", "kafka":1, "split":";", "split_op":"mean", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"new_sessions_per_second", "oid":".1.3.6.1.4.1.39483.1.1.0.10.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"sessions", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"stream_flushes_per_second", "oid":".1.3.6.1.4.1.39483.1.1.0.14.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"flushes", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"snort_cpu_idle", "oid":".1.3.6.1.4.1.39483.1.1.0.30.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"%", "split":";", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"snort_cpu", "op":"100-snort_cpu_idle_gid_6", "name_split_suffix":"_per_instance", "unit":"%", "kafka":1, "split":";", "split_op":"mean", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"total_sessions", "oid":".1.3.6.1.4.1.39483.1.1.0.12.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"sessions", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"stream5_mem_in_use", "oid":".1.3.6.1.4.1.39483.1.1.0.64.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"bytes", "kafka":1, "split":";", "split_op":"sum", "instance_prefix":"instance-","group_id":6, "group_name":"default" },
        {"name":"ratio_syn_synacks", "oid":".1.3.6.1.4.1.39483.1.1.0.65.4.1.2.9.115.104.101.108.108.116.101.115.116.1", "name_split_suffix":"_per_instance", "unit":"bytes", "kafka":1, "split":";", "split_op":"mean", "instance_prefix":"instance-","group_id":6, "group_name":"default" },

      ]
    }
  ]
}
